# ml-project-img-data-gen

The prompt-to-image training data generating code, for ML final project group 8.

## requirements

```bash
pip install -r requirements.txt
```

And follow the steps of [HPSv2](https://github.com/tgxs002/HPSv2?tab=readme-ov-file#quick-start) to install HPSv2 locally.

## Prompts

There are two files `./propmts/normal_prompts.csv` and `./prompts/modified_prompts.csv`.

`normal_prompts` are used as base prompts, and `modified_prompts` are modified from those base prompts, to get similar but different prompts.

fields: id, prompt

- id: int = 1 ~ 500
- prompt: str
  - generated by LLM (model: `gemini-2.5-pro`)

## Image generation

```bash
python3 gen_images.py
```

Use `runwayml/stable-diffusion-v1-5` to generate normal images.

Images generated are saved in folder `./outputs/normal/` and `./outputs/modified/`.

### Parameters
- num_inference_steps = 30
- guidance_scale = 7.5
- height, width = 512, 512

## Evaluate scores of images

```bash
python3 score_images.py
```

Scoring methods used:
- ImageReward (model = `ImageReward-v1.0`)
- CLIP (model = `openai/clip-vit-large-patch14`)
- HPS (version = `v2.1`)

The result is saved in `./scores/normal.csv` and `./scores/modified.csv`.


## Show all scores

```bash
python3 show_scores.py
```

Show the following informations for each image:
- id
- prompt
- path of image
- ImageReward score
- CLIP score
- HPS score